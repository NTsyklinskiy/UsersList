(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{143:function(e,t,n){"use strict";n.r(t);var r,a,c,s,o,i,u,l,j=n(0),d=n(91),b=n(142),h=n(26),O=n(39),p=n.n(O),f=n(144),x=n(68),v=n(32),m=n(96),g=n(97),k=n(153),w=n.n(k),C=function(){return new h.ApolloLink((function(e,t){return new p.a((function(n){var r;return Promise.resolve(e).then((function(e){return function(e,t){var n=localStorage.getItem("token");e.setContext({headers:{authorization:n}})}(e)})).then((function(){r=t(e).subscribe({next:n.next.bind(n),error:n.error.bind(n),complete:n.complete.bind(n)})})).catch(n.error.bind(n)),function(){r&&r.unsubscribe()}}))}))},I=n(27),y="SET_AUTH_USER",S="CLEAR_AUTH_USER",U={user:null},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(I.a)(Object(I.a)({},e),{},{user:t.payload});case S:return Object(I.a)(Object(I.a)({},e),U);default:return e}},L=n(2),A=Object(j.createContext)(),N={auth:U},$=function(e,t){return{auth:E(e.auth,t)}},B=function(e){var t=e.children;return Object(L.jsx)(A.Provider,{value:Object(j.useReducer)($,N),children:t})},D=function(){return Object(j.useContext)(A)},G=document.location.href.startsWith("http://localhost")?"http://localhost:4000/graphql":"",P=(n(135),n(159)),_=n(42),R=n(16),T=n(30),q=n(36),Q=Object(q.a)(r||(r=Object(T.a)(["\nquery { \n  allUsers {\n    id\n    name\n    email\n    password\n    isOnline\n    lastLoginAt\n    createdAt\n    active\n  }\n}\n"]))),z=Object(q.a)(a||(a=Object(T.a)(["\n  query {\n    getAuthUser {\n      id\n      name\n      email\n      createdAt\n      lastLoginAt\n      isOnline\n      }\n    }\n"]))),M=Object(q.a)(c||(c=Object(T.a)(["\n    mutation SIGNIN($email: String!,$password: String! ){\n      signin(email:$email, password: $password){\n        token\n      }\n    }\n"]))),F=Object(q.a)(s||(s=Object(T.a)(["\n    mutation SIGNUP($userInput: UserInputData ){\n      signup(userInput: $userInput){\n        token\n      }\n    }\n"]))),H=Object(q.a)(o||(o=Object(T.a)(["\n  mutation LOG_OUT($userId: String!){\n    logout(userId: $userId){\n      boolean\n    }\n  }\n"]))),J=Object(q.a)(i||(i=Object(T.a)(["\n  mutation DELETE_USERS($usersIds: [ID!]!){\n    deleteUsers(usersIds: $usersIds){\n      count\n    }\n  }\n"]))),K=Object(q.a)(u||(u=Object(T.a)(["\n  mutation BLOCK_USERS($usersIds: [ID!]!){\n    blockUsers(usersIds: $usersIds){\n      count\n    }\n  }\n"]))),W=Object(q.a)(l||(l=Object(T.a)(["\n  mutation UNBLOCK_USERS($usersIds: [ID!]!) {\n    unBlockUsers(usersIds: $usersIds){\n      count\n    }\n  }\n  "]))),V=n(17),X=n.n(V),Y=n(24),Z=n(14),ee=n(162),te=n(158),ne=n(160),re=n(35);function ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(j.useState)(e),n=Object(Z.a)(t,2),r=n[0],a=n[1],c=Object.values(e).join("");function s(e){var t=e.target,n=t.value,c=t.name,s=t.type;("number"===s&&(n=parseInt(n)),"file"===s)&&(n=Object(Z.a)(e.target.files,1)[0]);a(Object(I.a)(Object(I.a)({},r),{},Object(re.a)({},c,n)))}return Object(j.useEffect)((function(){a(e)}),[c]),{inputs:r,handleChange:s}}var ce=Object(R.f)((function(e){var t=e.history,n=e.refetch,r=Object(j.useState)(""),a=Object(Z.a)(r,2),c=(a[0],a[1]),s=ae({email:"",name:"",password:""}),o=s.inputs,i=s.handleChange,u=Object(ee.a)(F),l=Object(Z.a)(u,2),d=l[0],b=(l[1].loading,function(){var e=Object(Y.a)(X.a.mark((function e(r){var a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,d({variables:{userInput:o},refetchQueries:[{query:Q}]});case 4:return a=e.sent,localStorage.setItem("token",a.data.signup.token),e.next=8,n();case 8:t.push("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),c(e.t0.graphQLErrors[0].message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}());return Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)(te.a,{onSubmit:b,children:[Object(L.jsxs)(te.a.Group,{children:[Object(L.jsx)(te.a.Label,{children:"E-Mail"}),Object(L.jsx)(te.a.Control,{name:"email",type:"text",value:o.email,placeholder:"email",onChange:i})]}),Object(L.jsxs)(te.a.Group,{children:[Object(L.jsx)(te.a.Label,{children:"Name"}),Object(L.jsx)(te.a.Control,{name:"name",type:"text",value:o.name,placeholder:"name",onChange:i})]}),Object(L.jsxs)(te.a.Group,{controlId:"formBasicPassword",children:[Object(L.jsx)(te.a.Label,{children:"Password"}),Object(L.jsx)(te.a.Control,{type:"password",name:"password",value:o.password,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:i})]}),Object(L.jsx)(ne.a,{variant:"primary",type:"submit",children:"Sign Up"})]})})})),se=Object(R.f)((function(e){var t=e.history,n=e.location,r=e.refetch,a=ae({email:"",password:""}),c=a.inputs,s=a.handleChange,o=Object(j.useState)(""),i=Object(Z.a)(o,2),u=(i[0],i[1]),l=Object(ee.a)(M),d=Object(Z.a)(l,2),b=d[0];d[1].loading;Object(j.useEffect)((function(){u("")}),[n.pathname]);var h=function(){var e=Object(Y.a)(X.a.mark((function e(n){var a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,b({variables:{email:O,password:p},refetchQueries:[{query:Q}]});case 4:return a=e.sent,localStorage.setItem("token",a.data.signin.token),e.next=8,r();case 8:t.push("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),u(e.t0.graphQLErrors[0].message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),O=c.email,p=c.password;return Object(L.jsxs)(te.a,{onSubmit:h,children:[Object(L.jsxs)(te.a.Group,{children:[Object(L.jsx)(te.a.Label,{children:"E-Mail"}),Object(L.jsx)(te.a.Control,{name:"email",type:"text",value:O,placeholder:"email",onChange:s})]}),Object(L.jsxs)(te.a.Group,{controlId:"formBasicPassword",children:[Object(L.jsx)(te.a.Label,{children:"Password"}),Object(L.jsx)(te.a.Control,{type:"password",name:"password",value:p,placeholder:"password",onChange:s})]}),Object(L.jsx)(ne.a,{variant:"primary",type:"submit",children:"Sign In"})]})})),oe=n(154),ie=n(155),ue=function(e){var t=e.refetch;return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(oe.a,{children:Object(L.jsxs)(ie.a,{className:"justify-content-between gap-10 align-items-center vh-100",children:[Object(L.jsx)(se,{refetch:t}),Object(L.jsx)(ce,{refetch:t})]})})})},le=n(156),je=n(157),de=n(100);var be=function(e){var t=e.type,n=void 0===t?"checkbox":t,r=e.name,a=e.checked,c=void 0!==a&&a,s=e.onChange;return Object(L.jsx)("input",{type:n,name:r,checked:c,onChange:s})};function he(e){var t=new Date(+e);return t=t.toString().split(" "),"".concat(t[2]," ").concat(t[1]," ").concat(t[3]," ").concat(t[4])}function Oe(e){return Object.keys(Object.fromEntries(Object.entries(e).filter((function(e){var t=Object(Z.a)(e,2);t[0];return!1!==t[1]}))))}var pe=function(e){var t=e.data,n=e.refetchUser,r=e.refetchAllUsers,a=D(),c=Object(Z.a)(a,1)[0].auth.user.id;console.log(c);var s=Object(j.useState)([]),o=Object(Z.a)(s,2),i=o[0],u=o[1],l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object(j.useState)({}),n=Object(Z.a)(t,2),r=n[0],a=n[1];function c(e){var t=e.target,n=t.name,c=t.checked;a(Object(I.a)(Object(I.a)({},r),{},Object(re.a)({},n,c)))}function s(e){var t=Object.fromEntries(Object.entries(r).map((function(t){var n=Object(Z.a)(t,2),r=n[0];return n[1],[r,e]})));a(t)}function o(){s(!0)}function i(){s(!1)}return Object(j.useEffect)((function(){a((function(){return Object.assign.apply(Object,[{}].concat(Object(de.a)(e.map((function(e,t){return Object(re.a)({},e.id,!1)})))))}))}),[e]),{checkeds:r,handleChange:c,handleChangeAll:o,handleChangeNo:i}}(i),d=l.checkeds,b=l.handleChange,h=l.handleChangeAll,O=l.handleChangeNo,p=Object(ee.a)(J),f=Object(Z.a)(p,2),x=f[0],v=f[1],m=(v.loading,v.error,Object(ee.a)(K)),g=Object(Z.a)(m,2),k=g[0],w=g[1],C=(w.loading,w.error,Object(ee.a)(W)),y=Object(Z.a)(C,2),S=y[0],U=y[1],E=(U.loading,U.error,function(){var e=Object(Y.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Oe(d),e.next=4,k({variables:{usersIds:t}});case 4:return e.next=6,n();case 6:return e.next=8,r();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}()),A=function(){var e=Object(Y.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Oe(d),e.next=4,S({variables:{usersIds:t}});case 4:return e.next=6,n();case 6:return e.next=8,r();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(Y.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t=Oe(d)).some((function(e){return e===c}))&&window.localStorage.removeItem("token"),e.next=5,x({variables:{usersIds:t}});case 5:return e.next=7,n();case 7:return e.next=9,r();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=Object(Y.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r();case 3:return e.next=5,n();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(j.useEffect)(Object(Y.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(t),e.next=3,r();case 3:case"end":return e.stop()}}),e)}))),[t]),Object(L.jsxs)(oe.a,{children:[Object(L.jsx)(ie.a,{className:"justify-content-center",children:Object(L.jsxs)(le.a,{children:[Object(L.jsx)(ne.a,{onClick:E,children:"Block"}),Object(L.jsx)(ne.a,{onClick:A,children:"UnBlock"}),Object(L.jsx)(ne.a,{variant:"danger",onClick:N,children:"Delete"}),Object(L.jsx)(ne.a,{variant:"success",onClick:$,children:"UpdateUsers"})]})}),Object(L.jsxs)(je.a,{striped:!0,bordered:!0,hover:!0,children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:Object(L.jsxs)(le.a,{size:"sm",children:[Object(L.jsx)(ne.a,{onClick:h,children:"All"}),Object(L.jsx)(ne.a,{onClick:O,children:"No"})]})}),Object(L.jsx)("th",{children:"Id"}),Object(L.jsx)("th",{children:"Name"}),Object(L.jsx)("th",{children:"Email"}),Object(L.jsx)("th",{children:"Date"}),Object(L.jsx)("th",{children:"Last Login"}),Object(L.jsx)("th",{children:"Online Offline"}),Object(L.jsx)("th",{children:"Status Block"})]})}),Object(L.jsx)("tbody",{children:i.map((function(e,t){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:Object(L.jsx)(be,{name:e.id,checked:d[e.id],onChange:b})}),Object(L.jsx)("td",{children:e.id}),Object(L.jsx)("td",{children:e.name}),Object(L.jsx)("td",{children:e.email}),Object(L.jsx)("td",{children:he(e.createdAt)}),Object(L.jsx)("td",{children:he(e.lastLoginAt)}),Object(L.jsx)("td",{children:!0===e.isOnline?"Online":"Offline"}),Object(L.jsx)("td",{children:!0===e.active?"Not Blocked":"Blocked"})]},e.id)}))})]})]})},fe=Object(R.f)((function(e){e.location;var t,n=e.authUser,r=e.refetch,a=D(),c=Object(Z.a)(a,2),s=c[0].auth,o=c[1];Object(j.useEffect)((function(){o({type:y,payload:n})}),[o,n]);var i=Object(P.a)(Q),u=i.data,l=i.loading,d=(i.error,i.refetch),b=u?null===u||void 0===u?void 0:u.allUsers:[],h=null===s||void 0===s||null===(t=s.user)||void 0===t?void 0:t.id,O=Object(ee.a)(H),p=Object(Z.a)(O,2),f=p[0],x=(p[1].loading,function(){var e=Object(Y.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.localStorage.removeItem("token"),e.next=3,f({variables:{userId:h}});case 3:return e.next=5,r();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return s.user?l?Object(L.jsx)("div",{children:"Loading..."}):Object(L.jsxs)(oe.a,{className:"vh-100",children:[Object(L.jsx)(ne.a,{variant:"danger",onClick:x,children:"Log Out"}),u&&Object(L.jsx)(pe,{data:b,refetchUser:r,loadingAllUsers:l,refetchAllUsers:d})]}):null})),xe=function(){var e=Object(P.a)(z),t=e.loading,n=e.data,r=e.error,a=e.refetch;return t?Object(L.jsx)("div",{children:"Loading..."}):r?Object(L.jsx)("div",{children:r}):Object(L.jsx)(_.a,{children:Object(L.jsx)(R.c,{children:n.getAuthUser?Object(L.jsx)(R.a,{exact:!0,render:function(){return Object(L.jsx)(fe,{authUser:n.getAuthUser,refetch:a})}}):Object(L.jsx)(R.a,{exact:!0,render:function(){return Object(L.jsx)(ue,{refetch:a})}})})})},ve=function(e,t){var n=new f.a,r=Object(m.a)((function(e){var t=e.graphQLErrors,n=e.networkError;t&&t.map((function(e){var t=e.message,n=e.locations,r=e.path;return console.log("[GraphQL error]: Message: ".concat(t,", Location: ").concat(n,", Path: ").concat(r))})),n&&console.log("[Network error]: ".concat(n))})),a=C(),c=w()({uri:e}),s=localStorage.getItem("token"),o=new g.a({uri:t,options:{timeout:6e4,reconnect:!0,connectionParams:{authorization:s}}});o.subscriptionClient.maxConnectTimeGenerator.duration=function(){return o.subscriptionClient.maxConnectTimeGenerator.max};var i=Object(h.split)((function(e){var t=e.query,n=Object(v.e)(t),r=n.kind,a=n.operation;return"OperationDefinition"===r&&"subscription"===a}),o,c);return new x.a({link:h.ApolloLink.from([r,a,i]),cache:n})}(G,G.replace("http://","ws://"));Object(d.render)(Object(L.jsx)(b.a,{client:ve,children:Object(L.jsx)(B,{children:Object(L.jsx)(xe,{})})}),document.getElementById("root"))}},[[143,1,2]]]);
//# sourceMappingURL=main.9a810326.chunk.js.map